spring:
  application:
    name: retail-backend-test

  # MongoDB configuration for tests
  # Uses embedded MongoDB provided by de.flapdoodle.embed.mongo
  data:
    mongodb:
      # Embedded MongoDB will auto-configure on a random port
      # No manual configuration needed - flapdoodle handles it automatically
      database: test-retail-db

# Embedded MongoDB configuration
de:
  flapdoodle:
    mongodb:
      embedded:
        version: 7.0.14

  # Disable auto-configuration for external services during testing
  # MongoDB is enabled (using embedded) but others are disabled
  # Tests should use mocks or embedded/in-memory alternatives
  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration
      - org.springframework.boot.autoconfigure.data.redis.RedisReactiveAutoConfiguration
      - org.springframework.boot.autoconfigure.elasticsearch.ElasticsearchRestClientAutoConfiguration
      - org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchDataAutoConfiguration
      - org.springframework.boot.autoconfigure.r2dbc.R2dbcAutoConfiguration
      - org.springframework.boot.autoconfigure.data.r2dbc.R2dbcDataAutoConfiguration

# API configuration for tests
api:
  rate-limit:
    enabled: false  # Disable rate limiting in tests

# Test-specific settings
test:
  # Tenant context for tests
  default-tenant-id: test-tenant-001

  # Mock data configuration
  data:
    cleanup-after-test: true
    seed-before-test: false

logging:
  level:
    root: INFO
    com.retail: DEBUG
    org.springframework.test: INFO
    org.springframework.web: DEBUG
